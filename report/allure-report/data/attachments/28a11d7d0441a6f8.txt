//Status code check
pm.test("Status is 200", () => {
    console.log("Status Code:", pm.response.code);
    pm.response.to.have.status(200);
});

// Parse JSON once
let responseData = pm.response.json();
console.log("Full Response Body:", responseData);

//At least 1 user check
pm.test("Has at least 1 user", () => {
    console.log("User count in response:", responseData.data.length);
    pm.expect(responseData.data.length).to.be.above(0);
});

//Page number matches requested
let requestedPage = parseInt(pm.request.url.query.get("page"));
pm.test(`Page number matches requested (${requestedPage})`, () => {
    console.log("Requested page:", requestedPage);
    console.log("Page in response:", responseData.page);
    pm.expect(responseData.page).to.eql(requestedPage);
});

//Status code check
pm.test("Status is 200", () => {
    console.log("Status Code:", pm.response.code);
    pm.response.to.have.status(400);
});

// Parse JSON once
let responseData = pm.response.json();
console.log("Full Response Body:", responseData);

//At least 1 user check
pm.test("Has at least 1 user", () => {
    console.log("User count in response:", responseData.data.length);
    pm.expect(responseData.data.length).to.be.above(0);
});

// Get all IDs from the "data" list
let allIds = responseData.data.map(x => x.id);
console.log("All User IDs:", allIds);

// Choose one ID at random
let randomId = allIds[Math.floor(Math.random() * allIds.length)];
console.log("Randomly selected User ID:", randomId);

// Save it as "resource_id" for later requests
pm.environment.set("resource_id", randomId);
console.log(`Saved 'resource_id' in environment: ${randomId}`);
